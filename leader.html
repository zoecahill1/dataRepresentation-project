<html>
    <head>
        <title>View Poll</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    </head>
    <body>
        <h1>Favourite Movie Poll Leaderboard</h1>
		<div> <button id="adminForm" onclick=location.href='movieViewer.html';>Admin View</button></div>
        <div>
            <table class="table" id="movieTable">
                <tr>
                        <th>Name</th>
                        <th>Genre</th>
                        <th>Description</th>
                        <th>Votes</th>
                </tr>

            </table>
        </div>
	</body>
    <script>
	
	    function addmovieToTable(movie){
        var tableElement = document.getElementById('movieTable')
        var rowElement = tableElement.insertRow(-1)
        rowElement.setAttribute('id',movie.id)
        var cell1 = rowElement.insertCell(0);
        cell1.innerHTML = movie.name
        var cell2 = rowElement.insertCell(1);
        cell2.innerHTML = movie.genre
        var cell3 = rowElement.insertCell(2);
        cell3.innerHTML = movie.description
        var cell4 = rowElement.insertCell(3);
        cell4.innerHTML = movie.totalVotes
    }
	
	
		// All coming from test files
    function getAllAjax(){
        $.ajax({
            "url": "http://127.0.0.1:5000/votes/leaderboard",
            "method":"GET",
            "data":"",
            "dataType": "JSON",
            "success":function(result){
                console.log(result);
                for (movie of result){
                    addmovieToTable(movie);
                }
            },
            "error":function(xhr,status,error){
                console.log("error: "+status+" msg:"+error);
            }
        });
    }
	
	getAllAjax();
	
    </script>
</html>